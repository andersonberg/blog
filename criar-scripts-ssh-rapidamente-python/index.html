<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/blog/styles.28b715d0c0238008b3e5.css" id="gatsby-global-css">:root{--reach-skip-nav:1}[data-reach-skip-nav-link]{border:0;clip:rect(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute}[data-reach-skip-nav-link]:focus{padding:1rem;position:fixed;top:10px;left:10px;background:#fff;z-index:1;width:auto;height:auto;clip:auto}</style><meta name="generator" content="Gatsby 2.31.1"/><title data-react-helmet="true">Como Criar Scripts SSH Rapidamente com Python | Anderson Berg</title><meta data-react-helmet="true" name="description" content="Às vezes é necessário trabalhar com  vários  dispositivos ligados em  rede , quer sejam computadores, roteadores ou outros tipos de…"/><meta data-react-helmet="true" property="og:title" content="Como Criar Scripts SSH Rapidamente com Python"/><meta data-react-helmet="true" property="og:description" content="Às vezes é necessário trabalhar com  vários  dispositivos ligados em  rede , quer sejam computadores, roteadores ou outros tipos de…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:creator" content="Anderson Berg"/><meta data-react-helmet="true" name="twitter:title" content="Como Criar Scripts SSH Rapidamente com Python"/><meta data-react-helmet="true" name="twitter:description" content="Às vezes é necessário trabalhar com  vários  dispositivos ligados em  rede , quer sejam computadores, roteadores ou outros tipos de…"/><meta data-react-helmet="true" name="og:image" content="https://example.com/blog/static/322fb075d881a0776363117d6588b7f9/339b7/acesso-remoto-a-servidores.jpg"/><meta data-react-helmet="true" name="og:image:alt" content="Às vezes é necessário trabalhar com  vários  dispositivos ligados em  rede , quer sejam computadores, roteadores ou outros tipos de…"/><meta data-react-helmet="true" name="twitter:image" content="https://example.com/blog/static/322fb075d881a0776363117d6588b7f9/339b7/acesso-remoto-a-servidores.jpg"/><meta data-react-helmet="true" name="twitter:image:alt" content="Às vezes é necessário trabalhar com  vários  dispositivos ligados em  rede , quer sejam computadores, roteadores ou outros tipos de…"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><link as="script" rel="preload" href="/blog/styles-9411612e31e4f14527d1.js"/><link as="script" rel="preload" href="/blog/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-0edab85ce55c0548d50d.js"/><link as="script" rel="preload" href="/blog/app-b5ddeaf3f033bdd658c8.js"/><link as="script" rel="preload" href="/blog/commons-0de9c575cfebad7de24b.js"/><link as="script" rel="preload" href="/blog/framework-3e6dec6139dadaa7d0c7.js"/><link as="script" rel="preload" href="/blog/webpack-runtime-c5227b212e8476dbbce4.js"/><link as="fetch" rel="preload" href="/blog/page-data/criar-scripts-ssh-rapidamente-python/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/2744905544.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/3090755652.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/386998304.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/764694655.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="zk5xvy">body{--theme-ui-colors-text:#282c35;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#007acc;--theme-ui-colors-secondary:#1B1F23;--theme-ui-colors-muted:hsla(0,0%,0%,0.2);--theme-ui-colors-highlight:rgba(255,229,100,0.2);--theme-ui-colors-heading:#282c35;--theme-ui-colors-prism-background:#011627;--theme-ui-colors-prism-comment:#809393;--theme-ui-colors-prism-string:#addb67;--theme-ui-colors-prism-var:#d6deeb;--theme-ui-colors-prism-number:#f78c6c;--theme-ui-colors-prism-constant:#82aaff;--theme-ui-colors-prism-punctuation:#c792ea;--theme-ui-colors-prism-className:#ffc98b;--theme-ui-colors-prism-tag:#ffa7c4;--theme-ui-colors-prism-boolean:#ff5874;--theme-ui-colors-prism-property:#80cbc4;--theme-ui-colors-prism-namespace:#b2ccd6;--theme-ui-colors-prism-highlight:hsla(207,95%,15%,1);color:var(--theme-ui-colors-text,#282c35);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:rgba(255,255,255,0.86);--theme-ui-colors-background:#232129;--theme-ui-colors-primary:#D9BAE8;--theme-ui-colors-secondary:rgba(255,255,255,0.86);--theme-ui-colors-muted:hsla(0,0%,100%,0.2);--theme-ui-colors-highlight:#663399;--theme-ui-colors-heading:#fff;}</style><style data-emotion-css="8ir1vi">*{box-sizing:border-box;}body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="ocpejr">.css-ocpejr{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;}</style><div class="css-ocpejr"><header><style data-emotion-css="o7eq5i">.css-o7eq5i{color:var(--theme-ui-colors-primary,#007acc);}</style><a class="css-o7eq5i" href="#reach-skip-nav" data-reach-skip-link="" data-reach-skip-nav-link="">Skip to content</a><style data-emotion-css="1ufxd81">.css-1ufxd81{max-width:672px;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;padding-top:32px;}</style><div class="css-1ufxd81"><style data-emotion-css="4c94nt">.css-4c94nt{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:32px;}</style><div class="css-4c94nt"><style data-emotion-css="1qd1r5f">.css-1qd1r5f{margin-top:0;margin-bottom:0;}</style><p class="css-1qd1r5f"><style data-emotion-css="1febbns">.css-1febbns{box-shadow:none;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-primary,#007acc);}</style><style data-emotion-css="1a7e4c0">.css-1a7e4c0{color:var(--theme-ui-colors-primary,#007acc);box-shadow:none;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-primary,#007acc);}</style><a class="css-1a7e4c0" href="/blog/">Anderson Berg</a></p></div></div></header><div id="reach-skip-nav" data-reach-skip-nav-content=""></div><div><style data-emotion-css="1in33uw">.css-1in33uw{max-width:672px;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;padding-top:32px;padding-bottom:32px;}</style><div class="css-1in33uw"><main><article><header><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:57.97101449275362%"></div><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIFBP/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAG1gpIy4wV//8QAGRABAQADAQAAAAAAAAAAAAAAAgEAEBEy/9oACAEBAAEFAlbMdTB88nYdf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABwQAAICAgMAAAAAAAAAAAAAAAABEUECAxAhUf/aAAgBAQAGPwI6ezGPBE2O5d8f/8QAGhABAAIDAQAAAAAAAAAAAAAAAQARITFBEP/aAAgBAQABPyG+Q1oOxFkNjsxKiI13cUwFOwzNcjx//9oADAMBAAIAAwAAABB0z//EABYRAQEBAAAAAAAAAAAAAAAAAAEREP/aAAgBAwEBPxBG25//xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QEyf/xAAcEAEAAgIDAQAAAAAAAAAAAAABABEhYTFRcYH/2gAIAQEAAT8QysAtAvzAygcI/SPIR3EChoe7hlsCFMh1MetGKw0ahxP/2Q==" alt="Às vezes é necessário trabalhar com  vários  dispositivos ligados em  rede , quer sejam computadores, roteadores ou outros tipos de…" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/blog/static/322fb075d881a0776363117d6588b7f9/862d9/acesso-remoto-a-servidores.jpg 345w,
/blog/static/322fb075d881a0776363117d6588b7f9/339b7/acesso-remoto-a-servidores.jpg 620w" sizes="(max-width: 620px) 100vw, 620px" /><img loading="lazy" sizes="(max-width: 620px) 100vw, 620px" srcset="/blog/static/322fb075d881a0776363117d6588b7f9/862d9/acesso-remoto-a-servidores.jpg 345w,
/blog/static/322fb075d881a0776363117d6588b7f9/339b7/acesso-remoto-a-servidores.jpg 620w" src="/blog/static/322fb075d881a0776363117d6588b7f9/339b7/acesso-remoto-a-servidores.jpg" alt="Às vezes é necessário trabalhar com  vários  dispositivos ligados em  rede , quer sejam computadores, roteadores ou outros tipos de…" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><h1 class="css-0">Como Criar Scripts SSH Rapidamente com Python</h1><style data-emotion-css="1h1xv8c">.css-1h1xv8c{font-size:14px;margin-top:-16px;margin-bottom:16px;}</style><style data-emotion-css="dv5tmu">.css-dv5tmu{font-size:14px;margin-top:-16px;margin-bottom:16px;}.css-dv5tmu code{font-size:inherit;}</style><p class="css-dv5tmu">May 20, 2013</p></header><section><style data-emotion-css="1ek8oqb">.css-1ek8oqb code{font-size:inherit;}</style><p class="css-1ek8oqb">Às vezes é necessário trabalhar com <strong class="css-0">vários</strong> dispositivos ligados em <strong class="css-0">rede</strong>, quer sejam computadores, roteadores ou outros tipos de equipamentos.</p><p class="css-1ek8oqb">Em muitas ocasiões precisamos enviar <strong class="css-0">comandos</strong> e <strong class="css-0">instruções</strong> para estes equipamentos. Isso geralmente é feito através do envio de comandos ou dados via <strong class="css-0">SSH</strong>.</p><p class="css-1ek8oqb">Tudo bem entrar em um terminal e enviar um comando ou dois pra um equipamento ou outro.</p><p class="css-1ek8oqb">Mas e se forem <strong class="css-0">milhares</strong> de dispositivos interconectados?</p><p class="css-1ek8oqb">Ou se são <strong class="css-0">dezenas</strong> ou <strong class="css-0">centenas</strong> de instruções em série?</p><p class="css-1ek8oqb">E se estas duas situações ocorrem <strong class="css-0">juntas</strong>?</p><p class="css-1ek8oqb">Nesses casos é preciso criar scripts que façam tudo automatizado.</p><p class="css-1ek8oqb">Neste artigo vou compartilhar minha experiência com o Paramiko, um módulo Python que fornece uma interface ao protocolo SSH2.</p><p class="css-1ek8oqb">SSH é um protocolo de rede criptografado que realiza conexão segura entre computadores e permite executar comandos remotamente. Em diversas situações é necessário automatizar o processo de conexão e execução de comandos em um computador remoto.</p><style data-emotion-css="h7w91b">.css-h7w91b{pointer-events:painted;}.css-h7w91b a{visibility:hidden;}.css-h7w91b:hover a{visibility:visible;}</style><h2 id="como-instalar-o-paramiko" class="css-h7w91b"><style data-emotion-css="vvm4x1">.css-vvm4x1{margin-left:-20px;padding-right:4px;color:var(--theme-ui-colors-primary,#007acc);}</style><a href="#como-instalar-o-paramiko" aria-label="Como instalar o Paramiko" class="css-vvm4x1"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Como instalar o Paramiko</h2><p class="css-1ek8oqb">Para instalar o Paramiko é necessário instalar antes o PyCrypto, que pode ser encontrado via easy_install ou no repositório da sua distribuição Linux. Encontrei algumas dificuldades para instalar o pycrypto no Windows, por sorte existem alguns binários compilados do pycrypto: <a href="http://www.voidspace.org.uk/python/modules.shtml#pycrypto" class="css-o7eq5i">http://www.voidspace.org.uk/python/modules.shtml#pycrypto</a></p><p class="css-1ek8oqb">Depois é só instalar o paramiko via easy_install ou procurando no repositório da distro Linux.</p><p class="css-1ek8oqb">O paramiko tem uma classe base que fornece toda a interface para comunicação: <strong class="css-0"><em class="css-0">paramiko.SSHClient</em></strong>. Para criar um objeto e criar uma conexão com um servidor é bem simples:</p><style data-emotion-css="f4r2wo">.css-f4r2wo{font-family:Menlo,monospace;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;margin-bottom:8px;color:white;background-color:var(--theme-ui-colors-prism-background,#011627);overflow:auto;border-radius:10px;padding:16px;}.css-f4r2wo .attr-name{font-style:italic;}.css-f4r2wo .comment{color:var(--theme-ui-colors-prism-comment,#809393);}.css-f4r2wo .attr-name,.css-f4r2wo .string,.css-f4r2wo .url{color:var(--theme-ui-colors-prism-string,#addb67);}.css-f4r2wo .variable{color:var(--theme-ui-colors-prism-var,#d6deeb);}.css-f4r2wo .number{color:var(--theme-ui-colors-prism-number,#f78c6c);}.css-f4r2wo .builtin,.css-f4r2wo .char,.css-f4r2wo .constant,.css-f4r2wo .function{color:var(--theme-ui-colors-prism-constant,#82aaff);}.css-f4r2wo .punctuation,.css-f4r2wo .selector,.css-f4r2wo .doctype{color:var(--theme-ui-colors-prism-punctuation,#c792ea);}.css-f4r2wo .class-name{color:var(--theme-ui-colors-prism-className,#ffc98b);}.css-f4r2wo .tag,.css-f4r2wo .operator,.css-f4r2wo .keyword{color:var(--theme-ui-colors-prism-tag,#ffa7c4);}.css-f4r2wo .boolean{color:var(--theme-ui-colors-prism-boolean,#ff5874);}.css-f4r2wo .property{color:var(--theme-ui-colors-prism-property,#80cbc4);}.css-f4r2wo .namespace{color:var(--theme-ui-colors-prism-namespace,#b2ccd6);}.css-f4r2wo .highlight{background:hsla(0,0%,40%,.5);}</style><style data-emotion-css="1q7q4hh">.css-1q7q4hh{font-family:Menlo,monospace;font-size:inherit;}</style><style data-emotion-css="1eu4vb7">.css-1eu4vb7{font-family:Menlo,monospace;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;margin-bottom:8px;color:white;background-color:var(--theme-ui-colors-prism-background,#011627);overflow:auto;border-radius:10px;padding:16px;font-family:Menlo,monospace;font-size:inherit;}.css-1eu4vb7 .attr-name{font-style:italic;}.css-1eu4vb7 .comment{color:var(--theme-ui-colors-prism-comment,#809393);}.css-1eu4vb7 .attr-name,.css-1eu4vb7 .string,.css-1eu4vb7 .url{color:var(--theme-ui-colors-prism-string,#addb67);}.css-1eu4vb7 .variable{color:var(--theme-ui-colors-prism-var,#d6deeb);}.css-1eu4vb7 .number{color:var(--theme-ui-colors-prism-number,#f78c6c);}.css-1eu4vb7 .builtin,.css-1eu4vb7 .char,.css-1eu4vb7 .constant,.css-1eu4vb7 .function{color:var(--theme-ui-colors-prism-constant,#82aaff);}.css-1eu4vb7 .punctuation,.css-1eu4vb7 .selector,.css-1eu4vb7 .doctype{color:var(--theme-ui-colors-prism-punctuation,#c792ea);}.css-1eu4vb7 .class-name{color:var(--theme-ui-colors-prism-className,#ffc98b);}.css-1eu4vb7 .tag,.css-1eu4vb7 .operator,.css-1eu4vb7 .keyword{color:var(--theme-ui-colors-prism-tag,#ffa7c4);}.css-1eu4vb7 .boolean{color:var(--theme-ui-colors-prism-boolean,#ff5874);}.css-1eu4vb7 .property{color:var(--theme-ui-colors-prism-property,#80cbc4);}.css-1eu4vb7 .namespace{color:var(--theme-ui-colors-prism-namespace,#b2ccd6);}.css-1eu4vb7 .highlight{background:hsla(0,0%,40%,.5);}</style><pre class="language-python prism-code language-python css-1eu4vb7"><div class="token-line"><span class="token keyword">import</span><span class="token plain"> paramiko</span></div><div class="token-line"><span class="token plain">ssh </span><span class="token operator">=</span><span class="token plain"> paramiko</span><span class="token punctuation">.</span><span class="token plain">SSHClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh</span><span class="token punctuation">.</span><span class="token plain">connect</span><span class="token punctuation">(</span><span class="token string">&#x27;127.0.0.1&#x27;</span><span class="token punctuation">,</span><span class="token plain"> username</span><span class="token operator">=</span><span class="token string">&#x27;anderson&#x27;</span><span class="token punctuation">,</span><span class="token plain"> password</span><span class="token operator">=</span><span class="token string">&#x27;123&#x27;</span><span class="token punctuation">)</span></div></pre><p class="css-1ek8oqb">Neste exemplo, a função ‘connect’ está conectando ao servidor SSH local, passando nome de usuário e senha através dos par<!-- -->â<!-- -->metros ‘username’ e ‘password’, respectivamente.</p><p class="css-1ek8oqb">Quando você conecta em um servidor ssh pela primeira vez, uma chave é automaticamente armazenada em disco num arquivo chamado ”<strong class="css-0"><em class="css-0">.ssh/known_hosts</em></strong>” na sua pasta home. Para isto é preciso o usuário, manualmente, aceitar o armazenamento da chave do servidor, confirmando a confiabilidade deste. Para fazermos isso automaticamente através do Paramiko, utilizamos o objeto “set_missing_host_key_policy”, passando ”<strong class="css-0"><em class="css-0">paramiko.AutoAddPolicy()</em></strong>” como parâmetro para aceitar automaticamente as chaves. Então, nosso código anterior pode ser modificado:</p><pre class="language-python prism-code language-python css-1eu4vb7"><div class="token-line"><span class="token keyword">import</span><span class="token plain"> paramiko</span></div><div class="token-line"><span class="token plain">ssh </span><span class="token operator">=</span><span class="token plain"> paramiko</span><span class="token punctuation">.</span><span class="token plain">SSHClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh</span><span class="token punctuation">.</span><span class="token plain">set_missing_host_key_policy</span><span class="token punctuation">(</span><span class="token plain">paramiko</span><span class="token punctuation">.</span><span class="token plain">AutoAddPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh</span><span class="token punctuation">.</span><span class="token plain">connect</span><span class="token punctuation">(</span><span class="token string">&#x27;127.0.0.1&#x27;</span><span class="token punctuation">,</span><span class="token plain"> username</span><span class="token operator">=</span><span class="token string">&#x27;anderson&#x27;</span><span class="token punctuation">,</span><span class="token plain"> password</span><span class="token operator">=</span><span class="token string">&#x27;123&#x27;</span><span class="token punctuation">)</span></div></pre><p class="css-1ek8oqb">Tenha o cuidado de somente utilizar este artifício com servidores que você confia.</p><h2 id="enviando-comandos-via-ssh" class="css-h7w91b"><a href="#enviando-comandos-via-ssh" aria-label="Enviando comandos via ssh" class="css-vvm4x1"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enviando comandos via ssh</h2><p class="css-1ek8oqb">Já aprendemos como conectar em um computador remotamente via ssh. Agora vamos ver como enviar comandos e receber os resultados destes comandos. Isto é feito com o método “exec_command” do SSHClient(). Este método retorna uma tupla de objetos (stdin, stdout, stderr) que você pode ler (no caso do stdout e stderr) ou escrever (stdin). A sintaxe para executar um comando é a seguinte:</p><pre class="language-python prism-code language-python css-1eu4vb7"><div class="token-line"><span class="token plain">stdin</span><span class="token punctuation">,</span><span class="token plain"> stdout</span><span class="token punctuation">,</span><span class="token plain"> stderr </span><span class="token operator">=</span><span class="token plain"> ssh</span><span class="token punctuation">.</span><span class="token plain">exec_command</span><span class="token punctuation">(</span><span class="token string">&#x27;ls\n&#x27;</span><span class="token punctuation">)</span></div></pre><p class="css-1ek8oqb">Que vai enviar o comando ‘ls’ para listar os arquivos do diretório atual. Para exibir o retorno deste comando podemos ler o conteúdo do objeto stdout e, em seguida, fechar a conexão ssh:</p><pre class="language-python prism-code language-python css-1eu4vb7"><div class="token-line"><span class="token keyword">print</span><span class="token plain"> stdout</span><span class="token punctuation">.</span><span class="token plain">readlines</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh</span><span class="token punctuation">.</span><span class="token plain">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div></pre><p class="css-1ek8oqb">Em alguns casos precisamos enviar outras informações para execução do comando, como por exemplo uma senha de administrador. Podemos fazer isto escrevendo no objeto stdin.</p><pre class="language-python prism-code language-python css-1eu4vb7"><div class="token-line"><span class="token plain">stdin</span><span class="token punctuation">,</span><span class="token plain"> stdout</span><span class="token punctuation">,</span><span class="token plain"> stderr </span><span class="token operator">=</span><span class="token plain"> ssh</span><span class="token punctuation">.</span><span class="token plain">exec_command</span><span class="token punctuation">(</span><span class="token string">&#x27;sudo fdisk -l\n&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">stdin</span><span class="token punctuation">.</span><span class="token plain">write</span><span class="token punctuation">(</span><span class="token string">&#x27;1234\n&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">stdin</span><span class="token punctuation">.</span><span class="token plain">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token plain"> stdout</span><span class="token punctuation">.</span><span class="token plain">readlines</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div></pre><p class="css-1ek8oqb">O retorno dos comando pode ser tratado com as poderosas ferramentas de manipulação de string de Python, ou ainda filtradas com expressões regulares, dando ainda mais opções ao programador na hora de criar um script completo. Em outro post darei mais detalhes sobre a utilização do Paramiko.</p></section></article></main><style data-emotion-css="1i8tjli">.css-1i8tjli{margin-top:32px;padding-top:16px;}</style><footer class="css-1i8tjli"><style data-emotion-css="1u77lb1">.css-1u77lb1{border-color:var(--theme-ui-colors-muted,hsla(0,0%,0%,0.2));}</style><hr class="css-1u77lb1"/><style data-emotion-css="j6r63x">.css-j6r63x{margin-bottom:32px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion-css="u5xevn">.css-u5xevn{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:32px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-u5xevn"><style data-emotion-css="1emx3y6">.css-1emx3y6{margin-right:8px;margin-bottom:0;width:48px;min-width:48px;border-radius:99999px;}</style><div class="css-1emx3y6 gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:48px;height:48px"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAIDAAAAAAAAAAAAAAAAAAIDAQQF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQIA/9oADAMBAAIQAxAAAAHm36c5qStphkWsJ//EABwQAAICAgMAAAAAAAAAAAAAAAECAAMQERIxQf/aAAgBAQABBQJWcmxQqzepZZywe/J//8QAFREBAQAAAAAAAAAAAAAAAAAAICH/2gAIAQMBAT8Bg//EABURAQEAAAAAAAAAAAAAAAAAACAh/9oACAECAQE/AaP/xAAbEAEAAAcAAAAAAAAAAAAAAAABAAIQESAhcf/aAAgBAQAGPwIHcXlF7i1//8QAGxAAAwEBAAMAAAAAAAAAAAAAAAERMSEQUXH/2gAIAQEAAT8hkerc6qaYWBusTtfWGFLhbg9+xPH/2gAMAwEAAgADAAAAEHgYgP/EABYRAQEBAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPxAwMJ//xAAXEQEBAQEAAAAAAAAAAAAAAAABEBEx/9oACAECAQE/EHSQ5P/EABwQAQEBAQACAwAAAAAAAAAAAAERACExYUFRcf/aAAgBAQABPxBqgnEp+5NECiAeyfOJbb6z9EfJ7+9CODF5KmF0hDnWZq296KZ2+dXf/9k=" alt="Anderson Berg" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/blog/static/c32652ec49cd299c1b99dc17481ed005/ffcc9/avatar.jpg 1x,
/blog/static/c32652ec49cd299c1b99dc17481ed005/3e51d/avatar.jpg 1.5x,
/blog/static/c32652ec49cd299c1b99dc17481ed005/eee8e/avatar.jpg 2x" /><img loading="lazy" width="48" height="48" srcset="/blog/static/c32652ec49cd299c1b99dc17481ed005/ffcc9/avatar.jpg 1x,
/blog/static/c32652ec49cd299c1b99dc17481ed005/3e51d/avatar.jpg 1.5x,
/blog/static/c32652ec49cd299c1b99dc17481ed005/eee8e/avatar.jpg 2x" src="/blog/static/c32652ec49cd299c1b99dc17481ed005/ffcc9/avatar.jpg" alt="Anderson Berg" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><div class="css-0">Desenvolvedor Python</div></div><style data-emotion-css="11r1i3o">.css-11r1i3o{-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;list-style:none;padding:0;}</style><style data-emotion-css="15qbtrw">.css-15qbtrw{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;list-style:none;padding:0;}</style><ul class="css-15qbtrw"><li><a rel="prev" class="css-o7eq5i" href="/blog/recuperar-posts-twitter-rapidamente-python/">← <!-- -->Como Recuperar Posts do Twitter Rapidamente com Python</a></li><li><a rel="next" class="css-o7eq5i" href="/blog/criar-api-rest-django/">Como criar uma API REST com Django<!-- --> →</a></li></ul></footer></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/criar-scripts-ssh-rapidamente-python/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-eb0d07966faded618939.js"],"app":["/app-b5ddeaf3f033bdd658c8.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-0edab85ce55c0548d50d.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js-17f0fa5daef5072954f2.js"]};/*]]>*/</script><script src="/blog/polyfill-eb0d07966faded618939.js" nomodule=""></script><script src="/blog/webpack-runtime-c5227b212e8476dbbce4.js" async=""></script><script src="/blog/framework-3e6dec6139dadaa7d0c7.js" async=""></script><script src="/blog/commons-0de9c575cfebad7de24b.js" async=""></script><script src="/blog/app-b5ddeaf3f033bdd658c8.js" async=""></script><script src="/blog/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-0edab85ce55c0548d50d.js" async=""></script><script src="/blog/styles-9411612e31e4f14527d1.js" async=""></script></body></html>