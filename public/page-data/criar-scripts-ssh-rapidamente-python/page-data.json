{"componentChunkName":"component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js","path":"/criar-scripts-ssh-rapidamente-python/","result":{"data":{"site":{"siteMetadata":{"title":"Anderson Berg","social":[{"name":"twitter","url":"https://twitter.com/berg_pe"},{"name":"github","url":"https://github.com/andersonberg"}]}},"blogPost":{"__typename":"MdxBlogPost","id":"f5a00a9a-1291-5321-9bfe-3e64a233e4aa","excerpt":"Às vezes é necessário trabalhar com  vários  dispositivos ligados em  rede , quer sejam computadores, roteadores ou outros tipos de…","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Como Criar Scripts SSH Rapidamente com Python\",\n  \"date\": \"2013-05-20T13:45:46.000Z\",\n  \"tags\": [\"ssh\", \"script\"],\n  \"category\": \"Tutorial\",\n  \"slug\": \"criar-scripts-ssh-rapidamente-python\",\n  \"summary\": \"Às vezes é necessário trabalhar com vários dispositivos ligados em rede, quer sejam computadores, roteadores ou outros tipos de equipamentos. Em muitas ocasiões precisamos enviar comandos e instruções para estes equipamentos. Tudo bem entrar em um terminal e enviar um comando ou dois pra um equipamento ou outro. Mas e se forem milhares de dispositivos interconectados?\",\n  \"image\": \"images/acesso-remoto-a-servidores.jpg\",\n  \"alias\": \"/blog/criar-scripts-ssh-rapidamente-python/ /ssh-com-paramiko/\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\xC0s vezes \\xE9 necess\\xE1rio trabalhar com \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"v\\xE1rios\"), \" dispositivos ligados em \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"rede\"), \", quer sejam computadores, roteadores ou outros tipos de equipamentos.\"), mdx(\"p\", null, \"Em muitas ocasi\\xF5es precisamos enviar \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"comandos\"), \" e \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"instru\\xE7\\xF5es\"), \" para estes equipamentos. Isso geralmente \\xE9 feito atrav\\xE9s do envio de comandos ou dados via \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"SSH\"), \".\"), mdx(\"p\", null, \"Tudo bem entrar em um terminal e enviar um comando ou dois pra um equipamento ou outro.\"), mdx(\"p\", null, \"Mas e se forem \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"milhares\"), \" de dispositivos interconectados?\"), mdx(\"p\", null, \"Ou se s\\xE3o \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"dezenas\"), \" ou \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"centenas\"), \" de instru\\xE7\\xF5es em s\\xE9rie?\"), mdx(\"p\", null, \"E se estas duas situa\\xE7\\xF5es ocorrem \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"juntas\"), \"?\"), mdx(\"p\", null, \"Nesses casos \\xE9 preciso criar scripts que fa\\xE7am tudo automatizado.\"), mdx(\"p\", null, \"Neste artigo vou compartilhar minha experi\\xEAncia com o Paramiko, um m\\xF3dulo Python que fornece uma interface ao protocolo SSH2.\"), mdx(\"p\", null, \"SSH \\xE9 um protocolo de rede criptografado que realiza conex\\xE3o segura entre computadores e permite executar comandos remotamente. Em diversas situa\\xE7\\xF5es \\xE9 necess\\xE1rio automatizar o processo de conex\\xE3o e execu\\xE7\\xE3o de comandos em um computador remoto.\"), mdx(\"h2\", {\n    \"id\": \"como-instalar-o-paramiko\"\n  }, \"Como instalar o Paramiko\"), mdx(\"p\", null, \"Para instalar o Paramiko \\xE9 necess\\xE1rio instalar antes o PyCrypto, que pode ser encontrado via easy_install ou no reposit\\xF3rio da sua distribui\\xE7\\xE3o Linux. Encontrei algumas dificuldades para instalar o pycrypto no Windows, por sorte existem alguns bin\\xE1rios compilados do pycrypto: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://www.voidspace.org.uk/python/modules.shtml#pycrypto\"\n  }), \"http://www.voidspace.org.uk/python/modules.shtml#pycrypto\")), mdx(\"p\", null, \"Depois \\xE9 s\\xF3 instalar o paramiko via easy_install ou procurando no reposit\\xF3rio da distro Linux.\"), mdx(\"p\", null, \"O paramiko tem uma classe base que fornece toda a interface para comunica\\xE7\\xE3o: \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"em\", {\n    parentName: \"strong\"\n  }, \"paramiko.SSHClient\")), \". Para criar um objeto e criar uma conex\\xE3o com um servidor \\xE9 bem simples:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"import paramiko\\nssh = paramiko.SSHClient()\\nssh.connect('127.0.0.1', username='anderson', password='123')\\n\")), mdx(\"p\", null, \"Neste exemplo, a fun\\xE7\\xE3o \\u2018connect\\u2019 est\\xE1 conectando ao servidor SSH local, passando nome de usu\\xE1rio e senha atrav\\xE9s dos par\", \"\\xE2\", \"metros \\u2018username\\u2019 e \\u2018password\\u2019, respectivamente.\"), mdx(\"p\", null, \"Quando voc\\xEA conecta em um servidor ssh pela primeira vez, uma chave \\xE9 automaticamente armazenada em disco num arquivo chamado \\u201D\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"em\", {\n    parentName: \"strong\"\n  }, \".ssh/known_hosts\")), \"\\u201D na sua pasta home. Para isto \\xE9 preciso o usu\\xE1rio, manualmente, aceitar o armazenamento da chave do servidor, confirmando a confiabilidade deste. Para fazermos isso automaticamente atrav\\xE9s do Paramiko, utilizamos o objeto \\u201Cset_missing_host_key_policy\\u201D, passando \\u201D\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"em\", {\n    parentName: \"strong\"\n  }, \"paramiko.AutoAddPolicy()\")), \"\\u201D como par\\xE2metro para aceitar automaticamente as chaves. Ent\\xE3o, nosso c\\xF3digo anterior pode ser modificado:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"import paramiko\\nssh = paramiko.SSHClient()\\nssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())\\nssh.connect('127.0.0.1', username='anderson', password='123')\\n\")), mdx(\"p\", null, \"Tenha o cuidado de somente utilizar este artif\\xEDcio com servidores que voc\\xEA confia.\"), mdx(\"h2\", {\n    \"id\": \"enviando-comandos-via-ssh\"\n  }, \"Enviando comandos via ssh\"), mdx(\"p\", null, \"J\\xE1 aprendemos como conectar em um computador remotamente via ssh. Agora vamos ver como enviar comandos e receber os resultados destes comandos. Isto \\xE9 feito com o m\\xE9todo \\u201Cexec_command\\u201D do SSHClient(). Este m\\xE9todo retorna uma tupla de objetos (stdin, stdout, stderr) que voc\\xEA pode ler (no caso do stdout e stderr) ou escrever (stdin). A sintaxe para executar um comando \\xE9 a seguinte:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"stdin, stdout, stderr = ssh.exec_command('ls\\\\n')\\n\")), mdx(\"p\", null, \"Que vai enviar o comando \\u2018ls\\u2019 para listar os arquivos do diret\\xF3rio atual. Para exibir o retorno deste comando podemos ler o conte\\xFAdo do objeto stdout e, em seguida, fechar a conex\\xE3o ssh:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"print stdout.readlines()\\nssh.close()\\n\")), mdx(\"p\", null, \"Em alguns casos precisamos enviar outras informa\\xE7\\xF5es para execu\\xE7\\xE3o do comando, como por exemplo uma senha de administrador. Podemos fazer isto escrevendo no objeto stdin.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"stdin, stdout, stderr = ssh.exec_command('sudo fdisk -l\\\\n')\\nstdin.write('1234\\\\n')\\nstdin.flush()\\nprint stdout.readlines()\\n\")), mdx(\"p\", null, \"O retorno dos comando pode ser tratado com as poderosas ferramentas de manipula\\xE7\\xE3o de string de Python, ou ainda filtradas com express\\xF5es regulares, dando ainda mais op\\xE7\\xF5es ao programador na hora de criar um script completo. Em outro post darei mais detalhes sobre a utiliza\\xE7\\xE3o do Paramiko.\"));\n}\n;\nMDXContent.isMDXComponent = true;","slug":"/criar-scripts-ssh-rapidamente-python/","title":"Como Criar Scripts SSH Rapidamente com Python","tags":["ssh","script"],"date":"May 20, 2013","image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIFBP/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAG1gpIy4wV//8QAGRABAQADAQAAAAAAAAAAAAAAAgEAEBEy/9oACAEBAAEFAlbMdTB88nYdf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABwQAAICAgMAAAAAAAAAAAAAAAABEUECAxAhUf/aAAgBAQAGPwI6ezGPBE2O5d8f/8QAGhABAAIDAQAAAAAAAAAAAAAAAQARITFBEP/aAAgBAQABPyG+Q1oOxFkNjsxKiI13cUwFOwzNcjx//9oADAMBAAIAAwAAABB0z//EABYRAQEBAAAAAAAAAAAAAAAAAAEREP/aAAgBAwEBPxBG25//xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QEyf/xAAcEAEAAgIDAQAAAAAAAAAAAAABABEhYTFRcYH/2gAIAQEAAT8QysAtAvzAygcI/SPIR3EChoe7hlsCFMh1MetGKw0ahxP/2Q==","aspectRatio":1.725,"src":"/static/322fb075d881a0776363117d6588b7f9/339b7/acesso-remoto-a-servidores.jpg","srcSet":"/static/322fb075d881a0776363117d6588b7f9/862d9/acesso-remoto-a-servidores.jpg 345w,\n/static/322fb075d881a0776363117d6588b7f9/339b7/acesso-remoto-a-servidores.jpg 620w","sizes":"(max-width: 620px) 100vw, 620px"}}},"imageAlt":null,"imageCaptionText":null,"imageCaptionLink":null,"socialImage":null},"previous":{"__typename":"MdxBlogPost","id":"bd988436-eec3-5080-aeab-d2451877ab34","excerpt":"Neste post vamos criar um  crawler  para recuperar  tweets  públicos. Tweets públicos são aqueles que não necessitam de autenticação, ou…","slug":"/recuperar-posts-twitter-rapidamente-python/","title":"Como Recuperar Posts do Twitter Rapidamente com Python","date":"February 07, 2012"},"next":{"__typename":"MdxBlogPost","id":"cff9eee3-99cf-5fb2-8786-34d8b8d4badf","excerpt":"Como construir uma   API Restful   totalmente   configurável  ,   funcional   e   simples  ? Como tornar essa API  pública , ao mesmo tempo…","slug":"/criar-api-rest-django/","title":"Como criar uma API REST com Django","date":"October 05, 2014"}},"pageContext":{"id":"f5a00a9a-1291-5321-9bfe-3e64a233e4aa","previousId":"bd988436-eec3-5080-aeab-d2451877ab34","nextId":"cff9eee3-99cf-5fb2-8786-34d8b8d4badf","maxWidth":1380}},"staticQueryHashes":["2744905544","3090755652","386998304","764694655"]}